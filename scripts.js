const gamesData = {
    'popular-games': [{
            img: './images/Tetris.jpg',
            alt: 'Tetris',
            title: 'Tetris',
            rating: '★★★☆☆',
            description: 'This is a fun and exciting game that will keep you entertained for hours.etris is a classic puzzle game where players rotate falling blocks to form complete lines. It challenges strategic thinking and reflexes, becoming globally popular due to its addictive gameplay.',
            url: './Pages/Tetris/Tetris.html'
        }
        , {
            img: './images/EndlessTruckTeaser.jpg',
            alt: 'Endless Truck',
            title: 'Endless Truck',
            rating: '★★★★☆',
            description: 'Prove your driving skills in this highly addictive stunt game! Race your monster truck over ramps, collect money and try to drive as far as possible. Perform crazy flips, avoid bombs on the track and complete missions to earn additional cash. Stop by at the garage to upgrade your vehicle and go even farther. Can you achieve a top spot on the leaderboard?',
            url: 'https://games.cdn.famobi.com/html5games/e/endless-truck/v540/?fg_domain=play.famobi.com&fg_aid=A1000-111&fg_uid=a5ff2552-bbd9-4aff-9bcc-ec056478318d&fg_pid=e37ab3ce-88cd-4438-9b9c-a37df5d33736&fg_beat=235&original_ref=https%3A%2F%2Fh5-game.online'
        }
        , {
            img: './images/save-the-kingdom.jpg',
            alt: 'SAVE THE KINGDOM',
            title: 'Save The Kingdom',
            rating: '★★☆☆☆',
            description: 'Play Save The Kingdom a tower defense strategy game. Hordes of monsters, wizards, demons and ghosts are coming to capture your kingdom. Place various defense towers around the roads to stop them and save your land. Click on a tower to upgrade its abilities or sell the tower. To make your defense stronger upgrade your skills and unlock new towers. Play this strategy game online for free.',
            url: 'https://html5.gamemonetize.co/w7qxjbxcor7rl8zmerve6jm4rjan4tuc/'
        }
        , {
            img: './images/figure_02.webp',
            alt: 'Zoo Boom',
            title: 'Zoo Boom',
            rating: '★★★☆☆',
            description: 'Join the ultimate puzzle game adventure and match cute animal cubes! The gameplay is simple: just tap at least two animals of the same color to collect them for your zoo and complete all tasks to progress.',
            url: 'https://games.cdn.famobi.com/html5games/z/zoo-boom/cd0be843/?fg_domain=play.famobi.com&fg_aid=A1000-111&fg_uid=5e772ebe-9e0a-4cd3-adcf-bba662f35535&fg_pid=e37ab3ce-88cd-4438-9b9c-a37df5d33736&fg_beat=267&original_ref=https%3A%2F%2Fplay.famobi.com%2Fhtml5game%2F5e772ebe-9e0a-4cd3-adcf-bba662f35535%2FA1000-1'
        }
        , {
            img: './images/plants-vs-zombies.jpg',
            alt: 'Plants VS Zombies',
            title: 'Plants VS Zombies',
            rating: '★★★☆☆',
            description: 'Play Plants vs Zombies online for free. In this tower defense game the mission is to stop the zombie invasion and protect your main flower. Place defense plants along the road to make them shoot the incoming zombies. Each plant has his own strength and weakness so choose the best plants to use in this battle against zombies. The game Plants vs Zombies features a lot of various upgrades and bonuses.',
            url: 'https://html5.gamemonetize.com/iz9n0kx3zqfl4mo657zpb5y7v7qfbxij/'
        }

    ],
    'casual-games': [
        {
            img: './images/save-the-kingdom.jpg',
            alt: 'SAVE THE KINGDOM',
            title: 'Save The Kingdom',
            rating: '★★☆☆☆',
            description: 'Play Save The Kingdom a tower defense strategy game. Hordes of monsters, wizards, demons and ghosts are coming to capture your kingdom. Place various defense towers around the roads to stop them and save your land. Click on a tower to upgrade its abilities or sell the tower. To make your defense stronger upgrade your skills and unlock new towers. Play this strategy game online for free.',
            url: 'https://html5.gamemonetize.co/w7qxjbxcor7rl8zmerve6jm4rjan4tuc/'
        }

        , {
            img: './images/plants-vs-zombies.jpg',
            alt: 'Plants VS Zombies',
            title: 'Plants VS Zombies',
            rating: '★★★☆☆',
            description: 'Play Plants vs Zombies online for free. In this tower defense game the mission is to stop the zombie invasion and protect your main flower. Place defense plants along the road to make them shoot the incoming zombies. Each plant has his own strength and weakness so choose the best plants to use in this battle against zombies. The game Plants vs Zombies features a lot of various upgrades and bonuses.',
            url: 'https://html5.gamemonetize.com/iz9n0kx3zqfl4mo657zpb5y7v7qfbxij/'
        }
    ],
    'puzzle-games': [{
            img: './images/Tetris.jpg',
            alt: 'Tetris',
            title: 'Tetris',
            rating: '★★★★☆',
            description: 'This is a fun and exciting game that will keep you entertained for hours.etris is a classic puzzle game where players rotate falling blocks to form complete lines. It challenges strategic thinking and reflexes, becoming globally popular due to its addictive gameplay.',
            url: 'https://chvin.github.io/react-tetris/'
    }
    , {
        img: './images/figure_02.webp',
        alt: 'Zoo Boom',
        title: 'Zoo Boom',
        rating: '★★★☆☆',
        description: 'Join the ultimate puzzle game adventure and match cute animal cubes! The gameplay is simple: just tap at least two animals of the same color to collect them for your zoo and complete all tasks to progress.',
        url: 'https://games.cdn.famobi.com/html5games/z/zoo-boom/cd0be843/?fg_domain=play.famobi.com&fg_aid=A1000-111&fg_uid=5e772ebe-9e0a-4cd3-adcf-bba662f35535&fg_pid=e37ab3ce-88cd-4438-9b9c-a37df5d33736&fg_beat=267&original_ref=https%3A%2F%2Fplay.famobi.com%2Fhtml5game%2F5e772ebe-9e0a-4cd3-adcf-bba662f35535%2FA1000-1'
    }
    ],
    'other-games': [
        {
            img: './images/save-the-kingdom.jpg',
            alt: 'SAVE THE KINGDOM',
            title: 'Save The Kingdom',
            rating: '★★☆☆☆',
            description: 'Play Save The Kingdom a tower defense strategy game. Hordes of monsters, wizards, demons and ghosts are coming to capture your kingdom. Place various defense towers around the roads to stop them and save your land. Click on a tower to upgrade its abilities or sell the tower. To make your defense stronger upgrade your skills and unlock new towers. Play this strategy game online for free.',
            url: 'https://html5.gamemonetize.co/w7qxjbxcor7rl8zmerve6jm4rjan4tuc/'
        }]
};

function createGameCard(game) {
    return `
        <div class="game-card">
            <img src="${game.img}" alt="${game.alt}">
            <h3>${game.title}</h3>
            <div class="rating">${game.rating}</div>
            <p class="game-description" title="${game.description}">${game.description}</p>
            <button onclick="openGame('${game.alt.toLowerCase()}')">Play Now</button>
        </div>
    `;
}

function renderGames() {
    for (const sectionId in gamesData) {
        const container = document.querySelector(`#${sectionId} .games-container`);
        gamesData[sectionId].forEach(game => {
            container.innerHTML += createGameCard(game);
        });
    }
}

// 初始化渲染
renderGames();

function openGame(gameId) {
    const modal = new bootstrap.Modal(document.getElementById('gameModal'));
    const modalTitle = document.getElementById('gameModalLabel');
    const modalBody = document.getElementById('gameModalBody');
    
    // 查找对应的游戏数据
    const game = Object.values(gamesData).flat().find(g => g.alt.toLowerCase() === gameId);
    
    if (game) {
        modalTitle.textContent = `Starting ${game.title}`;
        modalBody.innerHTML = `<iframe src="${game.url}" style="width: 100%; height: 100%; border: none;"></iframe>`;
        modal.show();
    }
}

// 修复图片点击事件监听器
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.game-card img').forEach(img => {
        img.addEventListener('click', function() {
            const gameId = this.alt.toLowerCase();
            openGame(gameId);
        });
    });
});

// 添加滚动事件监听器
window.addEventListener('scroll', () => {
    const sections = document.querySelectorAll('section');
    const navLinks = document.querySelectorAll('nav ul li a');

    sections.forEach((section, index) => {
        const sectionTop = section.offsetTop - 50;
        const sectionBottom = sectionTop + section.offsetHeight;

        if (window.scrollY >= sectionTop && window.scrollY < sectionBottom) {
            navLinks.forEach(link => link.classList.remove('active'));
            navLinks[index].classList.add('active');
        }
    });
});